<!-- import React, { useState, useEffect, useCallback } from 'react'; 
import './video.css';
import ThumbUpOutlinedIcon from '@mui/icons-material/ThumbUpOutlined';
import ThumbDownAltOutlinedIcon from '@mui/icons-material/ThumbDownAltOutlined';
import { Link, useParams } from 'react-router-dom';
import axios from 'axios';
import { toast, ToastContainer } from 'react-toastify';
import 'react-toastify/dist/ReactToastify.css';
const Video = () => {
    const [like, setLike] = useState(0);
    const [dislike, setDislike] = useState(0);
    const [message, setMessage] = useState("");
    const [data, setData] = useState(null);
    const [videoUrl, setVideoURL] = useState("");
    const [suggestedVideos, setSuggestedVideos] = useState([]);
    const { id } = useParams();
    const [comment, setComments] = useState([]);
    const [isSubscribed, setIsSubscribed] = useState(false);
    const [hasIncremented, setHasIncremented] = useState(false);
    const fetchVideoData = useCallback(async () => {
        try {
            const videoResponse = await axios.get(`http://localhost:4000/api/getVideoById/${id}`);
            setData(videoResponse.data.video);
            setVideoURL(videoResponse.data.video.videoLink);
            setLike(videoResponse.data.video.like ? videoResponse.data.video.like.length : 0);
            setDislike(videoResponse.data.video.dislike ? videoResponse.data.video.dislike.length : 0);
            const commentResponse = await axios.get(`http://localhost:4000/commentApi/getCommentByVideoId/${id}`);
            setComments(commentResponse.data.comment);
            const suggestedResponse = await axios.get(`http://localhost:4000/api/allVideo`);
            setSuggestedVideos(suggestedResponse.data.video);
            console.log('Video Data:', videoResponse.data.video);
            console.log('Likes:', videoResponse.data.video.like);
            console.log('Dislikes:', videoResponse.data.video.dislike);
            console.log('Comments:', commentResponse.data.comment);
        } catch (err) {
            console.error("Error fetching video and comments:", err);
        }
    }, [id]);    
    useEffect(() => {
        fetchVideoData();
    }, [fetchVideoData]); 
    const handleViewIncrement = async () => {
        if (!hasIncremented) {
            try {
                await axios.put(`http://localhost:4000/api/incrementViews/${id}`);
                setHasIncremented(true);
            } catch (error) {
                console.error("Error incrementing view count:", error);
            }
        }
    };
    const handleComment = async () => {
        const body = { message, video: id };
        try {
            await axios.post('http://localhost:4000/commentApi/comment', body, { withCredentials: true }).then((resp) => {
                const newComment = resp.data.comment;
                setComments([newComment, ...comment]);
                setMessage("");
            });
        } catch (err) {
            toast.error("Please login first to comment");
        }
    };
    const handleSubscribe = async () => {
        try {
            const response = await axios.put(`http://localhost:4000/api/toggleSubscription/${data.user._id}`, {}, { withCredentials: true });
            setIsSubscribed(response.data.isSubscribed);
        } catch (error) {
            console.error("Error subscribing:", error);
        }
    };
    const handleLike = async () => {
        try {
            const response = await axios.put(`http://localhost:4000/api/video/like/${id}`, {}, { withCredentials: true });
            setLike(response.data.like);
            setDislike(response.data.dislike);
        } catch (error) {
            console.error("Error liking video:", error);
        }
    };
    const handleDislike = async () => {
        try {
            const response = await axios.put(`http://localhost:4000/api/video/dislike/${id}`, {}, { withCredentials: true });
            setLike(response.data.like);
            setDislike(response.data.dislike);
        } catch (error) {
            console.error("Error disliking video:", error);
        }
    };
    return (
        <div className='video'>
            <div className="videoPostSection">
                <div className="video_youtube">
                    {data && (
                        <video width="400" controls autoPlay onPlay={handleViewIncrement} className="video_youtube_video">
                            <source src={videoUrl} type="video/mp4" />
                            Your browser does not support the video tag.
                        </video>
                    )}
                </div>
                <div className="video_youtubeAbout">
                    <div className="video_uTubeTitle">{data?.title}</div>
                    <div className="youtube_video_ProfileBlock">
                        <div className="youtube_video_ProfileBlock_left">
                            <Link to={`/user/${data?.user?._id}`} className="youtube_video_ProfileBlock_left_img">
                                <img className='youtube_video_ProfileBlock_left_image' src={data?.user?.profilePic} alt="User Profile" />
                            </Link>
                            <Link to={`/user/${data?.user?._id}`} className="youtubeVideo_subsView">
                                <div className="youtubePostProfileName">{data?.user?.name}</div>
                                <div className="youtubePostProfileSubs">
                                    {data?.user?.subscribers ? `${data.user.subscribers} subscribers` : "No subscribers"}
                                </div>
                            </Link>
                            <div className="subscribeBtnYoutube" onClick={handleSubscribe}>
                                {isSubscribed ? 'Unsubscribe' : 'Subscribe'}
                            </div>
                        </div>
                        <div className="youtube_video_likeBlock">
                            <div className="youtube_video_likeBlock_Like" onClick={handleLike}>
                                <ThumbUpOutlinedIcon />
                                <div className="youtube_video_likeBlock_NoOfLikes">{like || 0}</div>
                            </div>
                            <div className="youtubeVideoDivider"></div>
                            <div className="youtube_video_likeBlock_Like" onClick={handleDislike}>
                                <ThumbDownAltOutlinedIcon />
                                <div className="youtube_video_likeBlock_NoOfDislikes">{dislike || 0}</div>
                            </div>
                        </div>
                    </div>
                    <div className="youtube_video_About">
                        <div>{data?.createdAt ? data.createdAt.slice(0, 10) : "Date not available"}</div>
                        <div>{data?.description}</div>
                    </div>
                </div>
                <div className="youtubeCommentSection">
                    <div className="youtubeCommentSectionTitle">{comment.length} Comments</div>
                    <div className="youtubeSelfComment">
                        <img className='video_youtubeSelfCommentProfile' src="https://th.bing.com/th/id/OIP.x-zcK4XvIdKjt7s4wJTWAgAAAA?w=360&h=360&rs=1&pid=ImgDetMain" alt="User Profile" />
                        <div className="addAComment">
                            <input type="text" className="addAcommentInput" placeholder="Add a comment..." value={message} onChange={(e) => setMessage(e.target.value)} />
                            <div className="cancelSubmitComment">
                                <div className="cancelComment" onClick={() => setMessage("")}>Cancel</div>
                                <div className="cancelComment" onClick={handleComment}>Comment</div>
                            </div>
                        </div>
                    </div>
                    <div className="youtubeOthersComments">
                        {(comment || []).map((item, index) => (
                            <div className="youtubeSelfComment" key={item._id || index}>
                                <img className='video_youtubeSelfCommentProfile' src={item?.user?.profilePic} alt="User Profile" />
                                <div className="others_commentSection">
                                    <div className="others_commentSectionHeader">
                                        <div className="channelName_comment">{item?.user?.username}</div>
                                        <div className="commentTimingOthers">
                                            {item?.createdAt ? new Date(item.createdAt).toLocaleDateString() : "Date not available"}
                                        </div>
                                    </div>
                                    <div className="otherCommentSectionComment">{item.message}</div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            </div>
            <div className="videoSuggestions">
                {suggestedVideos.length > 0 ? (
                    suggestedVideos.map((item) => (
                        <div className="videoSuggestionsBlock" key={item._id}>
                            <Link to={`/watch/${item._id}`} className="video_suggestion_link">
                                <div className="video_suggetion_thumbnail">
                                    <video autoPlay muted className='video_suggetion_thumbnail_img'>
                                        <source src={item.thumbnail} type="video/mp4" />
                                    </video>
                                </div>
                                <div className="video_suggetions_About">
                                    <div className="video_suggetions_About_title">{item.title}</div>
                                    <div className="video_suggetions_About_Profile">{item.user?.name}</div>
                                    <div className="video_suggetions_About_Profile">
                                        {item.views ? `${item.views} views` : "0 views"} . {item.createdAt ? item.createdAt.slice(0, 10) : "Date not available"}
                                    </div>
                                </div>
                            </Link>
                        </div>
                    ))
                ) : (
                    <p>No suggestions available.</p>
                )}
            </div>
            <ToastContainer />
        </div>
    );
};
export default Video; -->